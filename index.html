<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Trending RSS Reader</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }
        h1 {
            color: #0366d6;
            margin-bottom: 30px;
        }
        .feed-selector {
            margin-bottom: 20px;
        }
        select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .repo-item {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .repo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .repo-title {
            font-size: 1.4em;
            margin: 0;
        }
        .repo-title a {
            color: #0366d6;
            text-decoration: none;
        }
        .repo-title a:hover {
            text-decoration: underline;
        }
        .repo-description {
            margin-bottom: 15px;
        }
        .repo-readme {
            padding: 15px;
            background: white;
            border: 1px solid #e1e4e8;
            border-radius: 3px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .repo-meta {
            color: #586069;
            font-size: 0.9em;
        }
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #586069;
        }
        .toggle-btn {
            background: #0366d6;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
        }
        .toggle-btn:hover {
            background: #0258b8;
        }
    </style>
</head>
<body>
    <h1>GitHub Trending RSS Reader</h1>
    
    <div class="feed-selector">
        <label for="feed-select">Select RSS Feed:</label>
        <select id="feed-select">
            <option value="github-trending.xml">Default (github-trending.xml)</option>
            <option value="rss/python_daily.xml">Python Daily</option>
            <option value="rss/javascript_weekly.xml">JavaScript Weekly</option>
            <option value="rss/go_monthly.xml">Go Monthly</option>
        </select>
        <button id="load-btn" class="toggle-btn">Load Feed</button>
    </div>
    
    <div id="feed-container">
        <div class="loading">Select a feed and click "Load Feed" to view trending repositories</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const feedSelect = document.getElementById('feed-select');
            const loadBtn = document.getElementById('load-btn');
            const feedContainer = document.getElementById('feed-container');
            
            // Load the selected RSS feed
            loadBtn.addEventListener('click', () => {
                const selectedFeed = feedSelect.value;
                loadRSSFeed(selectedFeed);
            });
            
            function loadRSSFeed(feedUrl) {
                feedContainer.innerHTML = '<div class="loading">Loading RSS feed...</div>';
                
                fetch(feedUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`Failed to fetch RSS feed: ${response.status} ${response.statusText}`);
                        }
                        return response.text();
                    })
                    .then(data => {
                        const parser = new DOMParser();
                        const xml = parser.parseFromString(data, 'application/xml');
                        displayRSSFeed(xml);
                    })
                    .catch(error => {
                        feedContainer.innerHTML = `<div class="loading">Error loading RSS feed: ${error.message}</div>`;
                    });
            }
            
            function displayRSSFeed(xml) {
                const items = xml.querySelectorAll('item');
                
                if (items.length === 0) {
                    feedContainer.innerHTML = '<div class="loading">No repositories found in the RSS feed</div>';
                    return;
                }
                
                // Get feed title
                const feedTitle = xml.querySelector('channel > title')?.textContent || 'GitHub Trending';
                
                // Clear container and add title
                feedContainer.innerHTML = `<h2>${feedTitle}</h2>`;
                
                // Add each repository
                items.forEach(item => {
                    const title = item.querySelector('title')?.textContent || 'Unknown Repository';
                    const link = item.querySelector('link')?.textContent || '#';
                    const description = item.querySelector('description')?.textContent || '';
                    const content = item.querySelector('content\\:encoded')?.textContent || '';
                    
                    const repoDiv = document.createElement('div');
                    repoDiv.className = 'repo-item';
                    
                    const readmeContent = extractReadmeFromContent(content);
                    const hasReadme = readmeContent.trim() !== '';
                    
                    repoDiv.innerHTML = `
                        <div class="repo-header">
                            <h3 class="repo-title"><a href="${link}" target="_blank">${title}</a></h3>
                            ${hasReadme ? `<button class="toggle-btn toggle-readme">Show README</button>` : ''}
                        </div>
                        <div class="repo-description">${description}</div>
                        ${hasReadme ? `<div class="repo-readme" style="display:none;">${readmeContent}</div>` : ''}
                    `;
                    
                    feedContainer.appendChild(repoDiv);
                    
                    // Add event listener for the "Show README" button
                    if (hasReadme) {
                        const toggleBtn = repoDiv.querySelector('.toggle-readme');
                        const readmeDiv = repoDiv.querySelector('.repo-readme');
                        
                        toggleBtn.addEventListener('click', () => {
                            const isVisible = readmeDiv.style.display !== 'none';
                            readmeDiv.style.display = isVisible ? 'none' : 'block';
                            toggleBtn.textContent = isVisible ? 'Show README' : 'Hide README';
                        });
                    }
                });
            }
            
            function extractReadmeFromContent(content) {
                // This is a simple extraction - you might want to improve this
                // based on how your RSS content is structured
                
                // Remove HTML tags for the header part that we already display separately
                const strippedContent = content.replace(/<h1>.*?<\/h1>/s, '')
                                             .replace(/<p>.*?<\/p>/s, '');
                
                return strippedContent.trim();
            }
        });
    </script>
</body>
</html>